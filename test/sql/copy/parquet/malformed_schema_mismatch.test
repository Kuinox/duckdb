# name: test/sql/copy/parquet/malformed_schema_mismatch.test
# description: Test reading parquet file with schema-rowgroup column count mismatch
# group: [parquet]

require parquet

# This file has 3 columns in the schema but only 2 columns in the row group
# It was generated by parquet-dotnet with a bug that allowed incomplete column writes
statement error
SELECT * FROM 'test/sql/copy/parquet/broken/schemamismatch.parquet';
----
Parquet file is malformed

# Verify the error message mentions the schema mismatch
statement error
SELECT * FROM 'test/sql/copy/parquet/broken/schemamismatch.parquet';
----
schema references column index

statement error
SELECT * FROM 'test/sql/copy/parquet/broken/schemamismatch.parquet';
----
row group only has
